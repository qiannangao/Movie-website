<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="never">
    <title>Document</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/movie-detail.css">
    <style>

    </style>
</head>

<body>
    <div class="head">
        <div class="w">
            <div class="logo"></div>
            <div class="pos">
                郑州
                <img src="img/bd.png" alt="">
            </div>
            <ul class="nav">
                <li class="nav-item act">
                    <a href="index.html">首页</a>
                </li>
                <li class="nav-item">
                    <a href="">电影</a>
                </li>
                <li class="nav-item">
                    <a href="">影院</a>
                </li>
                <li class="nav-item">
                    <a href="">演出</a>
                </li>
                <li class="nav-item">
                    <a href="list.html">榜单</a>
                </li>
                <li class="nav-item">
                    <a href="">热点</a>
                </li>
                <li class="nav-item">
                    <a href="">商城</a>
                </li>
            </ul>
            <!-- <div class="user">
                <a href="mine.html" class="avatar"></a>
                <img src="img/bd.png" alt="">
                <ul class="mine-list">
                    <li>我的订单</li>
                    <li>我的信息</li>
                    <li>退出登录</li>
                </ul>
            </div> -->
            <div class="user">
                <a href="" class="avatar"></a>
                <img src="img/bd.png" alt="">
                <ul class="mine-list">
                    <li>我的订单</li>
                    <li class="mine-info">我的信息</li>
                    <li class="mine-unlog">退出登录</li>
                </ul>
            </div>
            <div class="search">
                <input type="text" placeholder="找影视剧；影人；影院">
                <div class="icon"></div>
            </div>
        </div>
    </div>
    <div class="bg">
        <div class="w">
            <div class="cover">

            </div>
            <div class="info"></div>
            <!-- 
                <div class="title">
                    我不是药神
                </div>
                <div class="en">Dying To Survive</div>
                <p class="type">剧情</p>
                <p class="time">中国大陆/117分钟</p>
                <p class="date">上映时间: 2019-08-01</p>
                <div class="btn view">
                    <img src="img/xin.png" alt="">
                    想看
                </div>
                <div class="btn score">
                    <img src="img/xinxi.png" alt="">
                    评分
        
            </div> -->
        </div>
    </div>
    <!-- 内容 -->
    <div class="content">
        <div class="w clearfix">
            <div class="title">

            </div>
            <div class="section">
                <div class="tab-nav clearfix">
                    <a href="#summary" class="act">介绍</a>
                    <a href="#actor">演职人员</a>
                    <a href="#imgs">图集</a>
                    <a href="#commet">评论</a>
                </div>
                <div id="summary">
                    <div class="tip">剧情简介</div>
                    <div class="text">
                        <!-- 印度神油店老板程勇日子过得窝囊，店里没生意，老父病危，手术费筹不齐。前妻跟有钱人怀上了孩子，还要把他儿子的抚养权给拿走。一日，店里来了一个白血病患者，求他从印度带回一批仿制的特效药，好让买不起天价正版药的患者保住一线生机。百般不愿却走投无路的程勇，意外因此一夕翻身，平价特效药救人无数，让他被病患封为“药神”，但随着利益而来的，是一场让他的生活以及贫穷病患性命都陷入危机的多方拉锯战
                        。 -->
                    </div>
                </div>
                <div id="actor">
                    <div class="tip">演职人员</div>
                    <div style="width: 148px;height: 20px;display: inline-block;font-size: 14px;">导演</div>
                    <div style="width: 28px;height: 20px;display: inline-block;font-size: 14px; ">演员</div>
                    <ul class="list clearfix" style="width:725px;height:214px">

                        <li class="item">

                            <!-- <img src="" alt="" class="avatar"> -->
                            <!-- <p>1</p> -->
                        </li>
                        <!-- <li class="item-actor">
                            <a href="">
                                <img src="" alt="">
                            </a>
                        </li> -->

                    </ul>
                </div>
                <div id="imgs">
                    <div class="tip">图集</div>
                    <ul class="img-list clearfix">
                        <li class="img-item">
                            <!-- <img src="" alt=""> -->
                        </li>

                    </ul>
                </div>
                <div id="commet">
                    <div class="tip">热评短评</div>
                    <ul class="com-list">
                        <!-- <li class="com-item">
                            <div class="info">
                                <div class="avatar"></div>
                                <div class="user">
                                    <div class="name">forwards</div>
                                    <div class="date">2022-4-9</div>
                                    <div class="rate">
                                        <img src="img/star.png" alt="">
                                    </div>
                                </div>
                                <div class="vote">
                                    <img src="img/xin.png" alt="">
                                    <span>2345</span>
                                </div>
                            </div>
                            <div class="text">
                                sdgfkjsdgjfgsdjfgjsdgfjgdsjfgjsdgfjgsdjfgsjdweuroweuroweuoruweo
                            </div>
                        </li> -->
                    </ul>
                </div>
            </div>
            <div class="aside">
                <div class="tab-nav clearfix">
                    <a href="#trailers" class="act">预告片</a>
                    <a href="#info">相关资讯</a>
                </div>
                <div id="trailers">
                    <div class="tip">预告片</div>
                    <ul class="trai-list ">
                        <li class="trai-item clearfix">
                            <!-- <a href="">
                                <div class="cover">
                                    <video src=""></video>
                                </div>

                            </a> -->
                        </li>
                    </ul>
                </div>
                <!-- <div id="info">
                    <div class="tip">相关资讯</div>
                </div> -->
            </div>
        </div>

    </div>

    <!-- 底部 -->
    <div class="foot">
        <div class="w">

            <p>关于虫虫 : 关于我们 管理团队 投资者关系 友情链接 : 美团网 格瓦拉 美团下载 欢喜首映</p>
            <p>商务合作邮箱：v@chongchong.com 客服电话：10665335 违法和不良信息/涉未成年人有害信息举报电话：4003456018900</p>
            <p>用户举报/涉未成年人有害信息举报邮箱：chongchong@.com 舞弊线索举报邮箱：wubijubao@comhcomg.com</p>
            <p>中华人民共和国增值电信业务经营许可证 京B2-20190350 营业性演出许可证 京演（机构）（2019）4094号</p>
            <p>广播电视节目制作经营许可证 （京）字第08478号 网络文化经营许可证 京网文（2022）1334-041号</p>
            <p>艺术品经营单位备案证明 京东艺（2022）0095号 </p>
        </div>
    </div>


    <script src="js/jquery.min.js"></script>
    <script src="./config.js"></script>
    <script>
        var token = localStorage.getItem('cctoken');
        if (!token) {
            // 未登录
            $('.user .avatar').text('登录')
            $('.user .avatar').click(function () {
                console.log(333);
                //  location.href = 'login.html'
                this.href = './login.html'
            })

        } else{
            $('.user .avatar').html(`<img src="./img/user.png" alt="" width="39px" height="39px">`)
        }
// 鼠标移入显示移出不显示
        $('.user ').mouseenter(function(){
            if(token){
             $('.mine-list')[0].style.display='block';
            }
        })
        $('.user ').mouseleave(function(){
            if(token){
             $('.mine-list')[0].style.display='none';
            }
        })
        $('.mine-unlog').click(function(){
            $('.user .avatar').text('登录');
            localStorage.removeItem("cctoken");
            localStorage.removeItem('logverify');
        })
        $('.mine-info').click(function(){
            console.log('个人信息点击了');
            location.href='./mine.html'
        })
    </script>
    <script>

        // 进入页面,需要知道获取哪一部电影的详情信息
        // 需要获取 url 的参数信息 (mId)
        console.log(location.search)
        var midVal = location.search.slice(1).split("=")[1];
        console.log(midVal);
        // 根据mid请求预告片
        $.ajax({
            type:'get',
            url:host+'/movie/findPreviewByMid',
            data:{
                mId:midVal
            },
            success:function(res){
                console.log(res);
                // let list=res.data.video;
                // let str3=``;
//             for(let i=0;i<list.length;i++){
// str3+=`<a href="./play.html?&mId=${res.data.mId}">
//                                 <div class="cover">
//                                     <video src=""></video>
//                                 </div>
//                             </a>`;
//             }
//                 $('.trai-item').html(str3)
                $('.trai-item').html(`<a href="./play.html?&mId=${res.data.mId}">
                                <div class="cover">
                                    <video src=""></video>
                                </div>
                            </a>`)
            }
        })
        // 根据 mid 请求电影详情
        $.ajax({
            type: "get",
            url: host + '/movie/subject',
            data: {
                mId: midVal
            },
            success: function (res) {
                console.log('根据id获得电影详情', res);
                let str = `
                <div class="title">
                   ${res.data.title}
                </div>
                <div class="en">${res.data.original_title}</div>
                <p class="type">剧情${res.data.genres}</p>
                <p class="time">中国大陆/${res.data.longtime}</p>
                <p class="date">上映时间: ${res.data.show_date}</p>
                <div class="btn view">
                    <img src="img/xin.png" alt="" >
                    想看
                </div>
                <div class="btn score">
                    <img src="img/xinxi.png" alt="">
                    评分${res.data.rating_average}
                </div>`;

                $(".w .info").html(str);
                $('.w .title').html(`虫虫电影 > 电影 > ${res.data.title}`);
                $('.w .cover').html(`<img src="${res.data.medium}" alt="" width='220px' onerror="reload()">`)
                $('#summary .text').text(`${res.data.summary}`);
                $('.list .item').html(`<img src="${res.data.players[0].avatar}" alt="" class="avatar">`)
                let str1 = ``;
                // res.data.players.length
                for (let i = 1; i < 5; i++) {
                    str1 += `<li class="item-actor">
                            <a href="">
                                <img src="${res.data.players[i].avatar}" alt="" style='float:left; margin-right: 20px;width:128px;height:170px' onerror="reload()">
                            </a>
                        </li>
                   `;

                }
                $('.list ').html(str1);
                $('.img-list .img-item').html(`<img src="${res.data.photos.img[0]}" alt="" onerror="reload()">`)
                let commentlist = res.data.comments.list;
                console.log(commentlist);
                let str2 = ``;
                for (let i = 0; i < 5; i++) {
                    str3 = ``;
                    for (let j = 0; j < commentlist[i].star / 10; j++) {
                        str3 += `<img src="img/star.png" alt="">`;
                    }
                    str2 += ` <li class="com-item">
                            <div class="info">
                                <div class="avatar">
                                    <img src="${commentlist[i].avatar}" alt="">
                                    </div>
                                <div class="user">
                                    <div class="name">${commentlist[i].author}</div>
                                    <div class="date">${commentlist[i].date}</div>
                                    <div class="rate">
                                      ${str3}  
                                    </div>
                                </div>
                                <div class="vote">
                                    <img src="img/xin.png" alt="">
                                    <span>${commentlist[i].vote}</span>
                                </div>
                            </div>
                            <div class="text">
                                ${commentlist[i].content}
                            </div>
                        </li>`;
                   
                }
                $('.com-list').html(str2);
          
            }
        })
       
        function reload() {
            event.target.src = './404.png';
        }  
    </script>
</body>

</html>